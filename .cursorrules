# Cursor Rules for AI Interview Platform

## Core Principles (Review Before Every Task)
1. **Regression Prevention**: You are a 1000x developer who ensures NOTHING breaks. Never change delivered functionality without explicit approval. Verify that new changes do not break existing regressions.
2. **Clutter Control**: Keep task lists focused (max 2-3 active stories). Focus on what matters now.
3. **Bold Strikes**: When a task is done, mark it clearly or remove it to keep the workspace clean.



## Project Overview
This is an AI-powered interview platform built with:
- **Frontend**: Next.js 14 (App Router), React, TypeScript, TailwindCSS
- **Backend**: FastAPI (Python), consolidated into `backend/app/`
- **AI**: Optimized 6-Agent Swarm (Strategy, Executioner, Evaluator, Observer, Critique, Monitor)

---

## Architecture Principles

### Modularity & Plug-and-Play
1. **Components should be self-contained** - Each component manages its own state, types, and styling
2. **Use composition over inheritance** - Build complex UIs by combining simple components
3. **Props for configuration** - Components should be configurable via props, not hardcoded
4. **Types co-located** - Keep interfaces/types in the same file or a nearby `types.ts`

### Component Structure
```
frontend/src/components/
├── ui/           # Reusable primitives (SearchBar, FilterChips, etc.)
├── forms/        # Form components (FileUpload, DataModelPanel)
├── cards/        # Card components (AccountCard, PositionCard)
├── grids/        # Grid/list containers (AccountGrid, PositionGrid)
└── modals/       # Modal dialogs (AddAccountModal, AddPositionModal)
```

---

## Common Mistakes to Avoid

### CSS / Layout
- [ ] **Always add `overflow-hidden`** to card containers to prevent content leaking
- [ ] **Use `min-w-0`** on flex children that need to truncate text
- [ ] **Use `flex-shrink-0`** on elements that shouldn't shrink (icons, badges)
- [ ] **Use `truncate` class** for single-line text that may overflow
- [ ] **Avoid fixed widths** - prefer responsive classes (w-full, flex-1)

### TypeScript
- [ ] **Define interfaces at top of file** before component
- [ ] **Export shared types** from a central `types.ts` if used across components
- [ ] **Use `Record<string, T>`** for dynamic keys instead of `any`

### React
- [ ] **Always provide `key` prop** in lists (use unique IDs, not indices)
- [ ] **Use `useCallback` for functions passed to children** to prevent re-renders
- [ ] **Clean up effects** - return cleanup function in useEffect when needed

### API Calls
- [ ] **Handle loading states** - show skeleton/spinner while fetching
- [ ] **Handle error states** - show user-friendly error messages
- [ ] **Use try/catch** in async functions with proper error logging

---

## Styling Conventions

### SwarmHire Brand Colors (Orange Core)
```css
--brand-primary: #FF6B35;   /* Signature Orange */
--accent-blue: #00D1FF;    /* Premium Cyan Accent */
--surface-dark: #0A0A0A;    /* Card Surface (Dark) */
--surface-primary: #000000; /* Page Background (Dark) */
--text-primary: #FFFFFF;    /* Main Text */
--glass-bg: rgba(255, 255, 255, 0.04);
```

### Component Patterns
```tsx
// Premium Glass Card
<div className="glass-card p-6 rounded-xl overflow-hidden">
  <div className="flex items-start gap-4">
    <div className="p-2 bg-brand-primary/10 rounded-lg flex-shrink-0">
      <Icon className="text-brand-primary" />
    </div>
    <div className="min-w-0 flex-1">
      <h3 className="text-lg font-bold truncate">...</h3>
      <p className="text-sm text-text-secondary line-clamp-2">...</p>
    </div>
  </div>
</div>

// SwarmHire Action Button
<button className="btn-primary rounded-lg shadow-lg shadow-orange-500/20">
  {loading ? <Spinner /> : 'Propel Swarm'}
</button>
```

---

## Backend Conventions

### API Endpoints
- `GET /api/{resource}` - List all
- `GET /api/{resource}/{id}` - Get one
- `POST /api/{resource}` - Create
- `PUT /api/{resource}/{id}` - Update
- `DELETE /api/{resource}/{id}` - Delete

### File Locations
```
backend/app/
├── main.py              # Central FastAPI application & RBAC enforcement
├── core/                # 6-Agent Swarm Orchestration
├── engine/              # Agent protocols and Intelligence dispatch
├── middleware/          # Role-Based Access Control (RBAC) & RLS helpers
├── services/            # Redis, LLM Router, and Payment integrations
└── (support)/           # websocket, utils, models, prompts, questions, resumes
```

---

## Testing Checklist

Before committing:
- [ ] Run `npm run build` - no TypeScript errors
- [ ] Test responsive layout (mobile, tablet, desktop)
- [ ] Test dark/light mode toggle
- [ ] Test empty states (no data)
- [ ] Test loading states
- [ ] Test error handling

## Build Verification Before Push

**CRITICAL: Always verify builds and restart servers before pushing to remote**

We do not push until verified it build and restart is fine no server issues.

**Strict Port Policy:**
- **Frontend MUST run on Port 3000**
- **Backend MUST run on Port 8000**
- If these ports are in use, **KILL** the existing blocking processes. Do not accept fallback ports (e.g., 3001).

**Port Kill Commands (PowerShell):**
> [!TIP]
> Child processes can sometimes persist. Use `/F /T` to kill process trees.
```powershell
# Check ports
Get-NetTCPConnection -LocalPort 3000,8000 | Select-Object LocalPort,OwningProcess,State

# Kill specific PID (and children)
taskkill /PID <PID> /F /T

# Aggressive cleanup (Kill by name)
taskkill /IM node.exe /F /T
taskkill /IM python.exe /F /T
```

Before pushing any changes:
1. **Frontend Build Check:**
   ```bash
   cd frontend && npm run build
   ```
   - Must complete without TypeScript errors
   - Must complete without build errors
   - Verify all pages compile successfully

2. **Backend Syntax Check:**
   ```bash
   cd backend && python -m py_compile main.py
   ```
   - Must have no syntax errors
   - Check for import errors

3. **Local Testing:**
   - Start backend: `cd backend && python main.py`
   - Start frontend: `cd frontend && npm run dev`
   - Verify basic functionality works locally

4. **Only after successful builds:**
   - Commit changes
   - Push to remote (GitHub/GitLab)
   - Monitor Render deployment logs

**NEVER push code that fails local build checks.**

---

## Quick References

### Start Development
```bash
# Terminal 1 - Backend
cd backend && python main.py

# Terminal 2 - Frontend
cd frontend && npm run dev
```

### Common Commands
```bash
# Add new dependency (frontend)
cd frontend && npm install <package>

# Add new dependency (backend)
pip install <package> && pip freeze > requirements.txt

# Format code
npm run lint -- --fix
```

---

## Notes & Learnings

### 2024-12-13
- Cards need `overflow-hidden` to prevent layout leaking
- Use `flex-shrink-0` on icons and badges
- Grid layouts: use responsive breakpoints (sm:, md:, lg:, xl:)


